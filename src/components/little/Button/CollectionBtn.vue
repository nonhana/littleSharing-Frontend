<template>
  <div class="collection-wrap" @click="thumbsUp(collectionmark)">
    <div ref="collection">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        fill="none"
        version="1.1"
        width="24"
        height="24"
        viewBox="0 0 24 24"
      >
        <defs>
          <clipPath id="master_svg0_3_4833">
            <rect x="0" y="0" width="24" height="24" rx="0" />
          </clipPath>
        </defs>
        <g clip-path="url(#master_svg0_3_4833)">
          <g>
            <path
              d="M7.64445,20.7333C6.76061,21.2563,5.6048,20.9858,5.06798,20.1343C4.8134999999999994,19.73,4.7344100000000005,19.2472,4.84748,18.7883L5.99147,14.1422C6.01923,14.032,5.98122,13.9162,5.89251,13.8407L2.147894,10.73323C1.370096,10.08824,1.2803200000000001,8.96025,1.945242,8.208269999999999C2.264808,7.8459,2.72317,7.62016,3.21838,7.58128L8.13271,7.20003C8.23981,7.19153,8.33563,7.12429,8.379470000000001,7.02204L10.2729,2.61186C10.66745,1.693123,11.7647,1.254381,12.7221,1.640124C13.1786,1.824916,13.5399,2.174258,13.7269,2.61186L15.6204,7.02179C15.6642,7.12428,15.76,7.19178,15.8671,7.20003L20.782,7.58153C21.8126,7.66153,22.5757,8.52976,22.494,9.5155C22.4557,9.9859,22.2252,10.42325,21.8522,10.73373L18.1076,13.8412C18.0204,13.9134,17.9811,14.0304,18.0086,14.1424L19.1526,18.7886C19.3894,19.7498,18.7746,20.7183,17.7711,20.9501C17.2878,21.0618,16.7776,20.9837,16.3554,20.7336L12.1477,18.2436C12.0573,18.1896,11.9425,18.1896,11.8521,18.2436L7.64419,20.7336L7.64445,20.7333ZM12.9793,16.9694L17.186999999999998,19.4593C17.2516,19.4973,17.3277,19.5091,17.399900000000002,19.4923C17.5576,19.4558,17.6598,19.2948,17.6196,19.1308L16.4756,14.4847C16.314500000000002,13.8333,16.5443,13.1505,17.0731,12.7097L20.8177,9.60249C20.8788,9.55174,20.9174,9.478,20.9242,9.3975C20.9382,9.23025,20.8137,9.088750000000001,20.6541,9.0765L15.7393,8.694759999999999C15.037,8.63862,14.4275,8.21125,14.1627,7.58928L12.2692,3.17935C12.2396,3.1085000000000003,12.1818,3.05169,12.1083,3.02135C11.9632,2.96285,11.7952,3.0301,11.7311,3.17935L9.83741,7.58928C9.57258,8.21125,8.963090000000001,8.63862,8.26081,8.694759999999999L3.3462199999999998,9.0765C3.26965,9.08285,3.19893,9.11815,3.14987,9.1745C3.0385999999999997,9.30248,3.05307,9.49126,3.18268,9.60249L6.9273,12.7099C7.45603,13.1507,7.68587,13.8336,7.52475,14.4849L6.38076,19.1308C6.36121,19.2097,6.37457,19.2927,6.41804,19.3623C6.50388,19.4981,6.67844,19.5388,6.81337,19.4591L11.0213,16.9694C11.6207,16.6142,12.3799,16.6142,12.9793,16.9694Z"
              :fill="fillcolor"
              fill-opacity="1"
            />
          </g>
        </g>
      </svg>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted, watch } from "vue";
import mojs from "@mojs/core";

const props = defineProps<{
  collectionmark: number;
}>();

const collection = ref<HTMLDivElement>();

let fillcolor = "#3d3d3d";
let burst: any;

const thumbsUp = (num: number) => {
  if (num == 0) {
    new mojs.Timeline().add(burst).play();
  }
};

watch(
  () => props.collectionmark,
  (newV, _) => {
    if (newV === 1) {
      fillcolor = "#00d5cc";
    } else {
      fillcolor = "#3d3d3d";
    }
  }
);

onMounted(() => {
  burst = new mojs.Burst({
    // 爆炸范围
    radius: { 0: 50 },
    // 动画挂载父元素，默认改在到body上
    parent: collection.value,
    // 动画延时函数
    easing: mojs.easing.bezier(0.1, 1, 0.3, 1),
    // 动画延时时间
    duration: 1500,
    // 动画等待时间
    delay: 300,
    // 扩散的粒子配置
    children: {
      duration: 750,
      // 随机数范围爆炸
      radius: { 0: "rand(5,25)" },
      shape: ["circle", "rect", "polygon"],
      // 粒子可选色
      fill: [
        "#1abc9c",
        "#2ecc71",
        "#00cec9",
        "#3498db",
        "#9b59b6",
        "#fdcb6e",
        "#f1c40f",
        "#e67e22",
        "#e74c3c",
        "#e84393",
      ],
      degreeShift: "rand(-90, 90)",
      delay: "stagger(0, 20)",
    },
    // 透明度
    opacity: 0.5,
    // 生成粒子数量
    count: 10,
  });
});
</script>

<style scoped lang="less">
.collection-wrap {
  position: relative;
  svg {
    cursor: pointer;
  }

  svg path {
    transition: all 0.2s;
  }

  svg:hover path {
    fill: #00d5cc;
  }
}
</style>
